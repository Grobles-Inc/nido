---

---

<section class="relative min-h-screen bg-gray-800 text-white">
  <!-- Background Image con overlay -->
  <div class="absolute inset-0 z-0">
    <img
      src="https://scontent.fayp1-1.fna.fbcdn.net/v/t39.30808-6/536284817_1363269709133617_617958273362021370_n.jpg?_nc_cat=111&ccb=1-7&_nc_sid=cc71e4&_nc_ohc=oLJX3NrJUykQ7kNvwH6VAxc&_nc_oc=AdltvWSATLmcgdKBBEP2UYgSTFG79Q8yjtjsWCypXrQZKzvZvQljGvdM4g18gjEmoC0p1LRlto8-Cx16E0rlxVhy&_nc_zt=23&_nc_ht=scontent.fayp1-1.fna&_nc_gid=TwZXTOf9_Go_U_erDIBLdA&oh=00_AfUBlsTsaeRrbNkViYI4fDwSSxA9ysZe-sue5UrjTrzTxQ&oe=68AE5D4C"
      class="w-full h-full object-cover object-bottom"
    />
  </div>
  <div class="absolute inset-0 bg-black opacity-50"></div>
</section>

<div
  class="max-w-7xl absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 mx-auto w-full lg:pt-16 pb-8"
>
  <!-- Grid adaptativo: vertical en móvil, horizontal en desktop -->
  <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 lg:gap-12 items-center">
    <div></div>
    <!-- Segunda columna: Formulario de inscripción -->
    <div class="flex items-center justify-center mt-8 lg:mt-20">
      <div class="w-full max-w-md">
        <form
          id="form-inscripcion"
          method="post"
          action="#"
          class="space-y-3 sm:space-y-4 bg-black/20 backdrop-blur-sm p-4 sm:p-6 rounded-2xl border border-white/20 shadow-lg"
        >
          <!-- Tipo de consulta -->
          <h2 class="font-bold text-white text-center text-2xl">
            Formulario de Consultas
          </h2>

          <!-- Nombre -->
          <div>
            <input
              type="text"
              id="name"
              name="name"
              placeholder="Nombres"
              class="input input-bordered w-full"
              required
              minlength="3"
            />
            <div
              id="name-error"
              class="error-message text-red-400 text-sm mt-1 hidden"
            >
              Ingrese sus nombres y apellidos
            </div>
          </div>

          <!-- Email -->
          <div>
            <input
              type="email"
              id="email"
              name="email"
              placeholder="Correo electrónico"
              class="input input-bordered w-full"
              required
            />
            <div
              id="email-error"
              class="error-message text-red-400 text-sm mt-1 hidden"
            >
              Ingrese un correo electrónico válido
            </div>
          </div>

          <!-- Teléfono -->
          <div>
            <input
              type="tel"
              id="phone"
              name="phone"
              placeholder="Número de teléfono"
              class="input input-bordered w-full"
              required
            />
            <div
              id="phone-error"
              class="error-message text-red-400 text-sm mt-1 hidden"
            >
              Ingrese un número de teléfono válido
            </div>
          </div>
          <div>
            <label
              for="request"
              class="block text-sm font-medium text-white mb-2"
            >
              Tipo de consulta <span class="text-red-400">*</span>
            </label>
            <select
              id="request"
              name="request"
              class="select select-bordered w-full"
              required
            >
              <option value="" disabled selected>Seleccione una opción</option>
              <option value="matricula">Proceso de matrícula</option>
              <option value="informacion">Información general</option>
              <option value="visita">Programar una visita</option>
            </select>
            <div
              id="request-error"
              class="error-message text-red-400 text-sm mt-1 hidden"
            >
              Por favor seleccione un tipo de consulta
            </div>
          </div>
          <!-- Mensaje -->
          <div>
            <label
              for="message"
              class="block text-sm font-medium text-white mb-2"
            >
              Mensaje <span class="text-red-400">*</span>
            </label>
            <textarea
              id="message"
              name="message"
              rows="3"
              placeholder="Escribe tu mensaje o información adicional sobre el niño(a)"
              class="textarea textarea-bordered w-full"
              minlength="5"></textarea>
            <div
              id="message-error"
              class="error-message text-red-400 text-sm mt-1 hidden"
            >
              Por favor ingrese un mensaje
            </div>
          </div>

          <button
            type="submit"
            id="submit-inscripcion-btn"
            class="w-full bg-secondary hover:bg-transparent border-2 border-secondary hover:text-secondary text-white font-bold py-2 sm:py-3 px-4 sm:px-6 rounded-full transition-colors duration-300 text-sm sm:text-base cursor-pointer"
          >
            Enviar
          </button>

          <div
            id="success-inscripcion-message"
            class="hidden bg-green-500/80 text-white p-3 rounded-lg text-center text-sm"
          >
            ¡Enviado correctamente!
          </div>
          <div
            id="error-inscripcion-alert"
            class="hidden bg-red-500/80 text-white p-3 rounded-lg text-center text-sm"
          >
            ¡Hubo un error!
          </div>
        </form>
      </div>
    </div>
  </div>
</div>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    const form = document.getElementById("form-inscripcion") as HTMLFormElement;
    const submitBtn = document.getElementById(
      "submit-inscripcion-btn",
    ) as HTMLButtonElement;
    const successMessage = document.getElementById(
      "success-inscripcion-message",
    ) as HTMLDivElement;
    const errorAlert = document.getElementById(
      "error-inscripcion-alert",
    ) as HTMLDivElement;

    if (!form || !submitBtn || !successMessage || !errorAlert) {
      console.error("Required DOM elements not found");
      return;
    }

    // Function to show error message and highlight input
    const showError = (inputId: string, show: boolean): void => {
      const input = document.getElementById(inputId) as
        | HTMLInputElement
        | HTMLSelectElement;
      const errorElement = document.getElementById(
        `${inputId}-error`,
      ) as HTMLDivElement;

      if (!input || !errorElement) {
        console.error(`Elements not found for id: ${inputId}`);
        return;
      }

      if (show) {
        input.classList.add("input-error");
        errorElement.classList.remove("hidden");
      } else {
        input.classList.remove("input-error");
        errorElement.classList.add("hidden");
      }
    };

    // Validate individual fields
    const validateField = (
      input: HTMLInputElement | HTMLSelectElement,
    ): boolean => {
      if (input.required && !input.value) {
        showError(input.id, true);
        return false;
      }

      if (input instanceof HTMLInputElement) {
        if (input.type === "email" && input.value) {
          const emailPattern =
            /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;
          if (!emailPattern.test(input.value)) {
            showError(input.id, true);
            return false;
          }
        }

        if (input.type === "tel" && input.value) {
          const phonePattern =
            /^[\+]?[(]?[0-9]{3}[)]?[-\s\.]?[0-9]{3}[-\s\.]?[0-9]{3,6}$/;
          if (!phonePattern.test(input.value)) {
            showError(input.id, true);
            return false;
          }
        }
      }

      if (input instanceof HTMLSelectElement && !input.value) {
        showError(input.id, true);
        return false;
      }

      if ("minLength" in input && input.value.length < input.minLength) {
        showError(input.id, true);
        return false;
      }

      showError(input.id, false);
      return true;
    };

    // Add input event listeners for real-time validation
    const inputs = form.querySelectorAll<HTMLInputElement | HTMLSelectElement>(
      "input, select",
    );
    inputs.forEach((input) => {
      input.addEventListener("input", () => validateField(input));
      input.addEventListener("blur", () => validateField(input));
    });

    form.addEventListener("submit", async (e: SubmitEvent) => {
      e.preventDefault();

      // Validate all fields
      let isValid = true;
      inputs.forEach((input) => {
        if (!validateField(input)) {
          isValid = false;
        }
      });

      if (!isValid) {
        return;
      }

      // Disable submit button and show loading state
      submitBtn.disabled = true;
      submitBtn.innerHTML = "Enviando...";

      try {
        const formData = new FormData(form);
        const data = Object.fromEntries(formData.entries());

        const response = await fetch("/api/contact", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
          },
          body: JSON.stringify(data),
        });

        if (response.ok) {
          // Show success message
          form.reset();
          successMessage.classList.remove("hidden");
          errorAlert.classList.add("hidden");
          setTimeout(() => {
            successMessage.classList.add("hidden");
          }, 5000);
        } else {
          throw new Error("Error en el envío");
        }
      } catch (error) {
        console.error("Error:", error);
        errorAlert.classList.remove("hidden");
        successMessage.classList.add("hidden");
        setTimeout(() => {
          errorAlert.classList.add("hidden");
        }, 5000);
      } finally {
        // Re-enable submit button
        submitBtn.disabled = false;
        submitBtn.innerHTML = "Solicitar Inscripción";
      }
    });
  });
</script>
